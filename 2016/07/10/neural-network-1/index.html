<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79896728-2', 'auto');
  ga('send', 'pageview');

</script>

  <title>æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼šæˆæœ¬å‡½æ•° å’Œ æ¢¯åº¦ä¸‹é™ &middot; Puxuan</title>

  <!-- CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700|PT+Serif:400,400italic,700,700italic" type="text/css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <!-- <link rel="stylesheet" href="/public/css/jekyll-github.css"> -->
  <link rel="stylesheet" href="/public/css/styles/atelier-forest-light.css">
  <script src="/public/css/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Insert to your webpage before the </head> -->
  <script src="/public/audioplayerengine/jquery.js"></script>
  <script src="/public/audioplayerengine/amazingaudioplayer.js"></script>
  <link rel="stylesheet" type="text/css" href="/public/audioplayerengine/initaudioplayer-1.css">
  <script src="/public/audioplayerengine/initaudioplayer-1.js"></script>
  <!-- End of head section HTML codes -->

  <link rel="canonical" href="http://puxuan.coding.me//2016/07/10/neural-network-1/" />

  

  

  

  <style>
    .content a,
    .related-posts li a:hover {
      color: #949667;
    }
    ::selection {
      color: #fff;
      background: #949667;
    }
    ::-moz-selection {
      color: #fff;
      background: #949667;
    }
  </style>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Puxuan" href="http://puxuan.coding.me//atom.xml">

</head>


  <body>
    <a id="_menu" class="menu" href="#_sidebar">â˜°</a>

    <main class="content container">
      


<article class="post">
  <h1 class="post-title">æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼šæˆæœ¬å‡½æ•° å’Œ æ¢¯åº¦ä¸‹é™</h1>
  <div class="post-date">
    <time datetime="2016-07-10T00:00:00+08:00">07/10/16</time>
    <span>on <a href="/tag/code/">Technique</a></span>
  </div>
  
  <hr/>
  <h2 id="section">å¦‚ä½•æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œ</h2>
<p>ä¸€èˆ¬çš„ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬éƒ½æœ‰å¤šå±‚ã€éçº¿æ€§çš„æ¿€æ´»å‡½æ•°ï¼ˆactivation functionï¼‰ï¼Œè€Œä¸”æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰åç½®é¡¹ã€‚</p>

<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æš‚æ—¶å…ˆåªå†™ä¸€å±‚ï¼Œä¸€ä¸ªæƒé‡å‚æ•° wï¼Œè¾“å‡ºæ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œæ²¡æœ‰åç½®é¡¹ã€‚</p>

<h3 id="section-1">å…ˆå¯¼å…¥ä¾èµ–</h3>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="c">#è®¾ç½® random çš„ seedï¼Œä½¿éšæœºå˜æˆä¼ªéšæœº</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="section-2">å®šä¹‰ç›®æ ‡å‡½æ•°</h3>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç›®æ ‡å‡½æ•°  <span class="MathJax_Preview">\mathbf{t}=f(\mathbf{x})+\mathcal{N}(0,0.2)</span><script type="math/tex">\mathbf{t}=f(\mathbf{x})+\mathcal{N}(0,0.2)</script></p>

<p>å…¶ä¸­ <span class="MathJax_Preview">\mathcal{N}(0,0.2)</span><script type="math/tex">\mathcal{N}(0,0.2)</script>æ˜¯æˆ‘ä»¬åŠ è¿›å»çš„é«˜æ–¯å™ªå£°ï¼ˆæ­£æ€åˆ†å¸ƒï¼‰,  <span class="MathJax_Preview">f(\mathbf{x})=\mathbf{x}*2</span><script type="math/tex">f(\mathbf{x})=\mathbf{x}*2</script> .</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># äº§ç”Ÿä¸€ä¸ªä¸€è‡´(0,1)åˆ†å¸ƒçš„20ä¸ªæ•°æ®, x.shape = (20,)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span>

<span class="n">noise_variance</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="c"># x.shape[0] = 20, randn è¾“å‡ºä¸€ä¸ª20(*1)çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒçŸ©é˜µ</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">noise_variance</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'t'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="s">'b-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'f(x)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$t$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'inputs (x) vs targets (t)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/nn1/output_5_0.png" alt="png" /></p>

<h3 id="section-3">å®šä¹‰æˆæœ¬å‡½æ•°</h3>

<p>æˆ‘ä»¬ç°åœ¨çš„æ¨¡å‹æ˜¯ <span class="MathJax_Preview">\mathbf{y} = \mathbf{x}*w</span><script type="math/tex">\mathbf{y} = \mathbf{x}*w</script>ã€‚</p>

<p>æˆ‘ä»¬ä¼˜åŒ–çš„ç›®çš„æ˜¯ä½¿ <span class="MathJax_Preview">\xi = \sum_{i=1}^{N} \Vert t_i - y_i \Vert ^2</span><script type="math/tex">\xi = \sum_{i=1}^{N} \Vert t_i - y_i \Vert ^2</script> å–åˆ°æœ€å°å€¼ã€‚</p>

<p>ç¥ç»ç½‘ç»œæ˜¯é€šè¿‡ <strong>nn(x,w)</strong> å‡½æ•°æ¥å®ç°çš„ï¼›æˆæœ¬å‡½æ•°æ˜¯é€šè¿‡ <strong>cost(y,t)</strong> æ¥å®ç°çš„ã€‚</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">w</span>

<span class="k">def</span> <span class="nf">cost</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">ws</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c"># ws æ˜¯ä¸€ä¸ª list, åŒ…å«0-4ä¹‹é—´çš„100ä¸ªå‡åŒ€åˆ†å¸ƒçš„æ•°</span>
<span class="n">cost_ws</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">cost</span><span class="p">(</span><span class="n">nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="p">,</span> <span class="n">t</span><span class="p">))(</span><span class="n">ws</span><span class="p">)</span>  <span class="c"># ws ä¸­æ¯ä¸ªå€¼å¯¹åº”çš„ cost</span>

<span class="c"># åˆ¶å›¾</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">cost_ws</span><span class="p">,</span> <span class="s">'r-'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$w$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">xi$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'cost vs. weight'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/nn1/output_8_0.png" alt="png" /></p>

<p>ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œw=2 çš„æ—¶å€™ <span class="MathJax_Preview">\xi</span><script type="math/tex">\xi</script> å€¼æœ€ä½ã€‚w=2 ä¹Ÿæ˜¯æˆ‘ä»¬ä¸º f(x) é€‰å®šçš„æ–œç‡ã€‚</p>

<p>æ³¨æ„è¿™ä¸ªæ–¹ç¨‹æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªæœ€å°å€¼ã€‚</p>

<h2 id="section-4">ä¼˜åŒ–æˆæœ¬å‡½æ•°</h2>

<p>è¿™ä¸ªä¾‹å­ä¸­æœ€ä½³æƒé‡ w ç”¨è‚‰çœ¼éƒ½å¯ä»¥çœ‹å‡ºæ¥ã€‚ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹é—®é¢˜æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œæ¯”å¦‚</p>

<ul>
  <li>å½“é‡åˆ° Rastrigin function çš„æ—¶å€™:</li>
</ul>

<div class="MathJax_Preview">f(\mathbf{x}) = An + \sum_{i=1}^n[x_i^2 - A cos(2\pi x_i)]</div>
<script type="math/tex; mode=display">f(\mathbf{x}) = An + \sum_{i=1}^n[x_i^2 - A cos(2\pi x_i)]</script>

<p>å…¶ä¸­ <span class="MathJax_Preview">A=10</span><script type="math/tex">A=10</script> ä¸” <span class="MathJax_Preview">x_i \in [-5.12, +5.12]</span><script type="math/tex">x_i \in [-5.12, +5.12]</script>. åœ¨ <span class="MathJax_Preview">x=0</span><script type="math/tex">x=0</script> å–æœ€å°å€¼ <span class="MathJax_Preview">f(x) = 0</span><script type="math/tex">f(x) = 0</script> .</p>

<ul>
  <li>å½“é‡åˆ°å¤šç»´çš„æƒ…å†µæ—¶ï¼šæ¯ä¸€ä¸ªå‚æ•°éƒ½ä¼šå¢åŠ ä¸€ç»´ã€‚</li>
</ul>

<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼˜åŒ–è¿™ä¸ªç®—æ³•ã€‚</p>

<h3 id="section-5">æ¢¯åº¦ä¸‹é™</h3>

<p>æœ€å¸¸ç”¨çš„ä¼˜åŒ–ç®—æ³•ä¹‹ä¸€å°±æ˜¯æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚å®ƒçš„åŸç†æ˜¯åœ¨æˆæœ¬å‡½æ•°çš„æŸä¸€ç‚¹ï¼ˆå‚æ•°ï¼‰ä¸Šå¯¹ <span class="MathJax_Preview">\xi</span><script type="math/tex">\xi</script> æ±‚å¯¼æ•°ï¼Œç„¶ååœ¨è´Ÿæ¢¯åº¦æ–¹å‘æ›´æ–°å‚æ•°ã€‚å‚æ•° w è¢«è¿­ä»£æ›´æ–°ï¼Œæ­¥æ•°ä¸è´Ÿæ¢¯åº¦æˆæ¯”ä¾‹ï¼š</p>

<div class="MathJax_Preview">w(k+1) = w(k) - \Delta w(k)</div>
<script type="math/tex; mode=display">w(k+1) = w(k) - \Delta w(k)</script>

<p>å…¶ä¸­ w(k) æ˜¯ç¬¬ k æ¬¡è¿­ä»£ä¸­ w çš„å€¼ã€‚</p>

<p><span class="MathJax_Preview">\Delta w</span><script type="math/tex">\Delta w</script> çš„å®šä¹‰ä¸ºï¼š
<span class="MathJax_Preview">\Delta w = \mu \frac{\partial \xi}{\partial w}</span><script type="math/tex">\Delta w = \mu \frac{\partial \xi}{\partial w}</script></p>

<p>å…¶ä¸­ï¼Œ<span class="MathJax_Preview">\mu</span><script type="math/tex">\mu</script> æ˜¯â€œå­¦ä¹ é€Ÿåº¦â€(learning rate)ï¼Œä¹Ÿå°±æ˜¯åœ¨æ¢¯åº¦æ–¹å‘ä¸Šç§»åŠ¨çš„è·ç¦»ã€‚</p>

<p>å¯¹äºæ ·æœ¬<span class="MathJax_Preview">i</span><script type="math/tex">i</script>, æ¢¯åº¦å¯ä»¥æ ¹æ®é“¾å¼æ³•åˆ™è¿›è¡Œæ‹†åˆ†:</p>

<div class="MathJax_Preview">\frac{\partial \xi_i}{\partial w} = \frac{\partial y_i}{\partial w} \frac{\partial \xi_i}{\partial y_i}</div>
<script type="math/tex; mode=display">\frac{\partial \xi_i}{\partial w} = \frac{\partial y_i}{\partial w} \frac{\partial \xi_i}{\partial y_i}</script>

<p>å…¶ä¸­ <span class="MathJax_Preview">\xi_i</span><script type="math/tex">\xi_i</script> æ˜¯å¹³æ–¹å·®æˆæœ¬ï¼Œæ‰€ä»¥ <span class="MathJax_Preview">{\partial \xi_i}/{\partial y_i}</span><script type="math/tex">{\partial \xi_i}/{\partial y_i}</script> å¯ä»¥å†™æˆï¼š</p>

<div class="MathJax_Preview">\frac{\partial \xi_i}{\partial y_i} = \frac{\partial (t_i - y_i)^2}{\partial y_i} = - 2 (t_i - y_i) = 2 (y_i - t_i)</div>
<script type="math/tex; mode=display">\frac{\partial \xi_i}{\partial y_i} = \frac{\partial (t_i - y_i)^2}{\partial y_i} = - 2 (t_i - y_i) = 2 (y_i - t_i)</script>

<p>åˆå› ä¸º <span class="MathJax_Preview">y_i = x_i * w</span><script type="math/tex">y_i = x_i * w</script>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠ <span class="MathJax_Preview">{\partial y_i}/{\partial w}</span><script type="math/tex">{\partial y_i}/{\partial w}</script> å†™æˆï¼š</p>

<div class="MathJax_Preview">\frac{\partial y_i}{\partial w} = \frac{\partial (x_i * w)}{\partial w} = x_i</div>
<script type="math/tex; mode=display">\frac{\partial y_i}{\partial w} = \frac{\partial (x_i * w)}{\partial w} = x_i</script>

<p>æ‰€ä»¥æ ·æœ¬<span class="MathJax_Preview">i</span><script type="math/tex">i</script>çš„ <span class="MathJax_Preview">\Delta w</span><script type="math/tex">\Delta w</script> æœ€ç»ˆå†™æˆï¼š</p>

<div class="MathJax_Preview">\Delta w = \mu * \frac{\partial \xi_i}{\partial w} = \mu * 2 x_i (y_i - t_i)</div>
<script type="math/tex; mode=display">\Delta w = \mu * \frac{\partial \xi_i}{\partial w} = \mu * 2 x_i (y_i - t_i)</script>

<p>æ¢¯åº¦ä¸‹é™å±äº<strong>åœ¨çº¿å¤„ç†(online processing)</strong>ï¼Œä¸ä¹‹å¯¹åº”çš„æ˜¯<strong>æ‰¹é‡å¤„ç†(batch processing)</strong>ã€‚åœ¨æ‰¹é‡å¤„ç†ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°æŠŠæ‰€æœ‰æ ·æœ¬çš„æ¢¯åº¦ç›¸åŠ ï¼š</p>

<div class="MathJax_Preview">\Delta w = \mu * 2 * \sum_{i=1}^{N} x_i (y_i - t_i)</div>
<script type="math/tex; mode=display">\Delta w = \mu * 2 * \sum_{i=1}^{N} x_i (y_i - t_i)</script>

<h3 id="section-6">ä½¿ç”¨æ¢¯åº¦ä¸‹é™</h3>

<p>éšæœºé€‰å–ä¸€ä¸ªåˆå§‹çš„å‚æ•°å€¼ w, ç„¶åä½¿ç”¨ <span class="MathJax_Preview">\Delta w</span><script type="math/tex">\Delta w</script> ä¸æ–­åœ°å¯¹ w è¿›è¡Œæ›´æ–°ç›´åˆ°æ”¶æ•›ã€‚</p>

<p>å­¦ä¹ é€Ÿåº¦ <span class="MathJax_Preview">\mu</span><script type="math/tex">\mu</script> åº”è¯¥æ‹¿å‡ºæ¥ä½œä¸ºä¸€ä¸ªè¶…å‚(hyperparameter)ï¼Œæ¯ä¸ªç¥ç»ç½‘ç»œéƒ½æœ‰ä¸åŒçš„å­¦ä¹ é€Ÿåº¦ã€‚</p>

<p>æ¢¯åº¦ <span class="MathJax_Preview">{\partial \xi}/{\partial w}</span><script type="math/tex">{\partial \xi}/{\partial w}</script> ç”±å‡½æ•° <strong>gradient(w, x, t)</strong> æ¥å®ç°ã€‚<span class="MathJax_Preview">\Delta w</span><script type="math/tex">\Delta w</script> æ˜¯ç”± <strong>delta_w(w_k, x, t, learning_rate)</strong> æ¥è®¡ç®—ã€‚</p>

<p>å¾ªç¯æ‰§è¡Œå››æ¬¡ï¼Œä¸”æ‰“å°å‡ºå½“å‰çš„ <span class="MathJax_Preview">w</span><script type="math/tex">w</script> å’Œ <span class="MathJax_Preview">\xi</span><script type="math/tex">\xi</script>ã€‚</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">delta_w</span><span class="p">(</span><span class="n">w_k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">gradient</span><span class="p">(</span><span class="n">w_k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>

<span class="c"># è®¾ç½®åˆå§‹ w å€¼</span>
<span class="n">w</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>


<span class="n">nb_of_iterations</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">w_cost</span> <span class="o">=</span> <span class="p">[(</span><span class="n">w</span><span class="p">,</span> <span class="n">cost</span><span class="p">(</span><span class="n">nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">t</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_of_iterations</span><span class="p">):</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">delta_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">dw</span>
    <span class="n">w_cost</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">cost</span><span class="p">(</span><span class="n">nn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">),</span> <span class="n">t</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w_cost</span><span class="p">)):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'w({}): {:.4f} </span><span class="se">\t</span><span class="s"> cost: {:.4f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">w_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">w_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>w(0): 0.1000 	 cost: 13.6197
w(1): 1.5277 	 cost: 1.1239
w(2): 1.8505 	 cost: 0.4853
w(3): 1.9234 	 cost: 0.4527
w(4): 1.9399 	 cost: 0.4510
</code></pre>
</div>

<p>å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œç¬¬äºŒæ¬¡è¿­ä»£å°±å¾ˆæ¥è¿‘æˆ‘ä»¬çš„ç›®æ ‡äº†ã€‚</p>

<p>æˆ‘ä»¬è¯•ç€ç”»ä¸ªå›¾çœ‹çœ‹ï¼ŒæŠŠå‰ä¸¤æ¬¡æ¢¯åº¦ä¸‹é™æ˜¾ç¤ºå‡ºæ¥ã€‚</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">cost_ws</span><span class="p">,</span> <span class="s">'r-'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w_cost</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">w1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">w_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">w2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">w_cost</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="s">'bo'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">],[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="s">'b-'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">c1</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="s">'$w({})$'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$w$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">xi$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Gradient descent updates plotted on cost function'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/nn1/output_15_0.png" alt="png" /></p>

<p>æˆ‘ä»¬ç”¨åæ¬¡æ¢¯åº¦ä¸‹é™çš„è¿­ä»£ï¼Œä¸åŸæ¥çš„æ–¹æ³•ç›¸æ¯”ï¼Œç”»å›¾æ¯”è¾ƒä¸€ä¸‹ã€‚</p>

<p>ï¼ˆä¸¤æ¡çº¿éƒ½è¿‡(0,0)ä¸€ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åŠ åç½®é¡¹(bias term)ï¼‰</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">w</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">nb_of_iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_of_iterations</span><span class="p">):</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">delta_w</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">dw</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'t'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span> <span class="s">'b-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'f(x)'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">w</span><span class="p">],</span> <span class="s">'r-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'fitted line'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'input x'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'target t'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'input vs. target'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/nn1/output_18_0.png" alt="png" /></p>


</article>


<aside class="author">
  <h2 class="aside-title">About</h2>

  
  <img class="me" src="/public/img/profile.jpg" alt="Puxuan Yu"/>
  

  <p>Software Engineering @ WuhanU ğŸ‡¨ğŸ‡³ , ISTJ.</p>

</aside>


<aside class="related">
  <h2 class="aside-title">Related Posts</h2>
  <ul class="related-posts">
    
    
    
      
      
        <li>
          <h4>
            <a href="/2016/12/07/image-segmention/">
              <span>Efficient Graph-based Image Segmentation</span>
              <small>12/07/16</small>
            </a>
          </h4>
        </li>
      
    
      
      
        <li>
          <h4>
            <a href="/2016/11/11/intro-to-xgboost/">
              <span>XGBoostè¯¦è§£</span>
              <small>11/11/16</small>
            </a>
          </h4>
        </li>
      
    
      
      
        <li>
          <h4>
            <a href="/2016/10/28/nnfml1/">
              <span>æœºå™¨å­¦ä¹ ä¸­çš„ç¥ç»ç½‘ç»œ-ç¬”è®°(1)</span>
              <small>10/28/16</small>
            </a>
          </h4>
        </li>
      
    
      
      
    
  </ul>
</aside>


<!-- å¤šè¯´è¯„è®ºæ¡† start -->
	<div class="ds-thread" data-thread-key='/2016/07/10/neural-network-1' data-title="æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼šæˆæœ¬å‡½æ•° å’Œ æ¢¯åº¦ä¸‹é™" data-url='http://puxuan.coding.me//2016/07/10/neural-network-1/'></div>
<!-- å¤šè¯´è¯„è®ºæ¡† end -->
<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"lucius0814"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->


    </main>

    





<div   id="_backdrop" class="backdrop"></div>
<aside id="_sidebar" class="sidebar" style="background-image:url('/public/img/code.jpg')">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1><a href="/">Puxuan</a></h1>
      <p>10^14 synapses in a brain, and 10^9 seconds in a life.</p>

    </div>

    <nav class="sidebar-nav">
      <ul>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/code/">Technique</a>
          </li>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/travel/">Travel</a>
          </li>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/music/">Music</a>
          </li>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/other/">Misc</a>
          </li>
        

        

        
        
          
            
          
        
          
            
            <li>
              <a class="sidebar-nav-item " href="/about/">About</a>
            </li>
            
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
        
      </ul>
    </nav>

    <div class="sidebar-social">
      
        <a href="https://github.com/PxYu" target="_blank"><span class="icon-github"></span></a>

      

      
        <a href="https://instagram.com/pxyuwhu" target="_blank"><span class="icon-instagram"></span></a>

      

      
        <a href="https://twitter.com/pxyuwhu" target="_blank"><span class="icon-twitter-square"></span></a>

      

      
        <a href="https://facebook.com/martin.yu.5249" target="_blank"><span class="icon-facebook-square"></span></a>

      

      
        <a href="https://weibo.com/u/3290896193" target="_blank"><span class="icon-weibo"></span></a>

      


    </div>
  </div>
</aside>


    <script src="/public/js/hydejack.js" async></script>
  </body>
</html>
