<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79896728-2', 'auto');
  ga('send', 'pageview');

</script>

  <title>æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼šé€»è¾‘åˆ†ç±»å‡½æ•° &middot; Puxuan</title>

  <!-- CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700|PT+Serif:400,400italic,700,700italic" type="text/css">
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <!-- <link rel="stylesheet" href="/public/css/jekyll-github.css"> -->
  <link rel="stylesheet" href="/public/css/styles/atelier-forest-light.css">
  <script src="/public/css/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Insert to your webpage before the </head> -->
  <script src="/public/audioplayerengine/jquery.js"></script>
  <script src="/public/audioplayerengine/amazingaudioplayer.js"></script>
  <link rel="stylesheet" type="text/css" href="/public/audioplayerengine/initaudioplayer-1.css">
  <script src="/public/audioplayerengine/initaudioplayer-1.js"></script>
  <!-- End of head section HTML codes -->

  <link rel="canonical" href="http://puxuan.coding.me//2016/07/11/neural-network-2/" />

  

  

  

  <style>
    .content a,
    .related-posts li a:hover {
      color: #949667;
    }
    ::selection {
      color: #fff;
      background: #949667;
    }
    ::-moz-selection {
      color: #fff;
      background: #949667;
    }
  </style>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Puxuan" href="http://puxuan.coding.me//atom.xml">

</head>


  <body>
    <a id="_menu" class="menu" href="#_sidebar">â˜°</a>

    <main class="content container">
      


<article class="post">
  <h1 class="post-title">æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼šé€»è¾‘åˆ†ç±»å‡½æ•°</h1>
  <div class="post-date">
    <time datetime="2016-07-11T00:00:00+08:00">07/11/16</time>
    <span>on <a href="/tag/code/">Technique</a></span>
  </div>
  
  <hr/>
  <h2 id="section">å®ç°ç¥ç»ç½‘ç»œï¼šé€»è¾‘åˆ†ç±»å‡½æ•°</h2>

<p>å¦‚æœæƒ³ç”¨ç¥ç»ç½‘ç»œæ¥å®Œæˆåˆ†ç±»çš„å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¾“å‡º <span class="MathJax_Preview">t</span><script type="math/tex">t</script> è¾“å‡ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚</p>

<p>å¦‚æœåªåˆ†ä¸¤ç±»ï¼š<span class="MathJax_Preview">t=1</span><script type="math/tex">t=1</script> æˆ– <span class="MathJax_Preview">t=0</span><script type="math/tex">t=0</script>,æˆ‘ä»¬ç”¨é€»è¾‘å›å½’ä¸­çš„é€»è¾‘å‡½æ•°ã€‚</p>

<p>å¦‚æœè¦åˆ†å¤šç±»ï¼Œä¸Šè¿°å‡½æ•°æœ‰æ‰©å±•ç‰ˆæœ¬ç§°ä¸º <strong>softmax function</strong>ã€‚</p>

<p>ä¸‹é¢æˆ‘ä»¬ä¸»è¦è®²ä¸€ä¸‹é€»è¾‘å‡½æ•°ã€‚</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre>
</div>

<h3 id="section-1">é€»è¾‘å‡½æ•°</h3>

<p>ç›®æ ‡æ˜¯é€šè¿‡è¾“å…¥<span class="MathJax_Preview">z</span><script type="math/tex">z</script>é¢„æµ‹ç›®æ ‡ç±»<span class="MathJax_Preview">t</span><script type="math/tex">t</script>ã€‚è¾“å…¥<span class="MathJax_Preview">z</span><script type="math/tex">z</script>è¢«å½’ä¸º <span class="MathJax_Preview">t=1</span><script type="math/tex">t=1</script> æ—¶çš„æ¦‚ç‡ <span class="MathJax_Preview">P(t=1 \mid z)</span><script type="math/tex">P(t=1 \mid z)</script> ç”¨é€»è¾‘å‡½æ•° <span class="MathJax_Preview">y = \sigma(z)</span><script type="math/tex">y = \sigma(z)</script> çš„è¾“å‡º<span class="MathJax_Preview">y</span><script type="math/tex">y</script>æ¥è¡¨ç¤ºã€‚<span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script>å³æ˜¯é€»è¾‘å‡½æ•°ï¼Œå…¶å®šä¹‰ä¸ºï¼š</p>

<div class="MathJax_Preview">\sigma(z) = \frac{1}{1+e^{-z}}</div>
<script type="math/tex; mode=display">\sigma(z) = \frac{1}{1+e^{-z}}</script>

<p>å¯¹äºç»™å®šçš„è¾“å…¥<span class="MathJax_Preview">z</span><script type="math/tex">z</script>ï¼Œåˆ†ç±»çš„ä¸¤ç§ç»“æœçš„æ¦‚ç‡åˆ†åˆ«å†™ä¸ºï¼š</p>

<div class="MathJax_Preview">P(t=1\mid z) = \sigma(z) = \frac{1}{1+e^{-z}}</div>
<script type="math/tex; mode=display">P(t=1\mid z) = \sigma(z) = \frac{1}{1+e^{-z}}</script>

<div class="MathJax_Preview">P(t=0\mid z) = 1 - \sigma(z) = \frac{e^{-z}}{1+e^{-z}}</div>
<script type="math/tex; mode=display">P(t=0\mid z) = 1 - \sigma(z) = \frac{e^{-z}}{1+e^{-z}}</script>

<p>æ³¨æ„è¿™é‡Œçš„è¾“å…¥ <span class="MathJax_Preview">z</span><script type="math/tex">z</script> å…¶å®å°±æ˜¯æ¦‚ç‡æ¯”çš„å¯¹æ•°ï¼š</p>

<div class="MathJax_Preview">log \frac{P(t=1\mid z)}{P(t=0\mid z)} = log \frac{\frac{1}{1+e^{-z}}}{\frac{e^{-z}}{1+e^{-z}}} = log \frac{1}{e^{-z}} = log(1) - log(e^{-z}) = z</div>
<script type="math/tex; mode=display">log \frac{P(t=1\mid z)}{P(t=0\mid z)} = log \frac{\frac{1}{1+e^{-z}}}{\frac{e^{-z}}{1+e^{-z}}} = log \frac{1}{e^{-z}} = log(1) - log(e^{-z}) = z</script>

<p>è¿™æ„å‘³ç€ å¯¹æ•°æ¦‚ç‡æ¯”(log odds ratio): <span class="MathJax_Preview">log(P(t=1\mid z)/P(t=0\mid z))</span><script type="math/tex">log(P(t=1\mid z)/P(t=0\mid z))</script> éšç€<span class="MathJax_Preview">z</span><script type="math/tex">z</script>æ˜¯çº¿æ€§å˜åŒ–çš„ã€‚é‚£ä¹ˆå¦‚æœè¯´ç¥ç»ç½‘ç»œä¸­ <span class="MathJax_Preview">z = x * w</span><script type="math/tex">z = x * w</script>ï¼Œé‚£ä¹ˆå¯¹æ•°æ¦‚ç‡æ¯”éšç€å‚æ•° w å’Œè¾“å…¥æ ·æœ¬ x çº¿æ€§å˜åŒ–ã€‚</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s">'b-'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$z$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$</span><span class="err">\</span><span class="s">sigma(z)$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'logistic function'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/nn2/output_5_0.png" alt="png" /></p>

<h3 id="section-2">é€»è¾‘å‡½æ•°çš„å¯¼æ•°</h3>

<p>ç¥ç»ç½‘ç»œä¸­ç»å¸¸ä½¿ç”¨åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œæ‰€ä»¥æœ‰å¿…è¦è®¡ç®—ä¸€ä¸‹è¾“å‡º <span class="MathJax_Preview">y</span><script type="math/tex">y</script> å…³äºè¾“å…¥ <span class="MathJax_Preview">x</span><script type="math/tex">x</script> çš„å¯¼æ•°ã€‚</p>

<div class="MathJax_Preview">\frac{\partial y}{\partial z} = \frac{\partial \sigma(z)}{\partial z} = \frac{\partial \frac{1}{1+e^{-z}}}{\partial z} = \frac{-1}{(1+e^{-z})^2} *e^{-z}*-1 = \frac{1}{1+e^{-z}} \frac{e^{-z}}{1+e^{-z}} = y(1-y)</div>
<script type="math/tex; mode=display">\frac{\partial y}{\partial z} = \frac{\partial \sigma(z)}{\partial z} = \frac{\partial \frac{1}{1+e^{-z}}}{\partial z} = \frac{-1}{(1+e^{-z})^2} *e^{-z}*-1 = \frac{1}{1+e^{-z}} \frac{e^{-z}}{1+e^{-z}} = y(1-y)</script>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">logistic_derivative</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">logistic</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">logistic_derivative</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s">'r-'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$z$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">frac{</span><span class="se">\\</span><span class="s">partial </span><span class="se">\\</span><span class="s">sigma(z)}{</span><span class="se">\\</span><span class="s">partial z}$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'derivative of the logistic function'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/nn2/output_8_0.png" alt="png" /></p>

<h3 id="section-3">é€»è¾‘å‡½æ•°çš„ äº¤å‰ç†µæˆæœ¬å‡½æ•°</h3>

<p>å›é¡¾ä¸€ä¸‹é€»è¾‘å‡½æ•° <span class="MathJax_Preview">y = \sigma (z)</span><script type="math/tex">y = \sigma (z)</script>ï¼Œè¾“å…¥<span class="MathJax_Preview">z</span><script type="math/tex">z</script>å±äºä¸€ç±»(t=1)çš„æ¦‚ç‡ä¸º<span class="MathJax_Preview">y</span><script type="math/tex">y</script>ï¼Œå±äºå¦ä¸€ç±»(t=0)çš„æ¦‚ç‡ä¸º <span class="MathJax_Preview">1-y</span><script type="math/tex">1-y</script>ã€‚æˆ‘ä»¬è®°ä¸ºï¼š<span class="MathJax_Preview">P(t=1\mid z) = \sigma(z) = y</span><script type="math/tex">P(t=1\mid z) = \sigma(z) = y</script></p>

<p>åœ¨è¿™ä¸ªæƒ…å†µä¸‹å¦‚ä½•ä¼˜åŒ–ç¥ç»ç½‘ç»œæ¨¡å‹å‘¢ï¼Ÿ</p>

<p>åœ¨çº¿æ€§å›å½’é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ç”¨çš„ <span class="MathJax_Preview">J(\theta)</span><script type="math/tex">J(\theta)</script> åœ¨è¿™é‡Œå¹¶ä¸é€‚ç”¨ï¼Œå› ä¸ºå®ƒä¸å†æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—é‡æ–°å»æƒ³ä¸€ä¸ªè¯¯å·®å‡½æ•°æ¥è¯„ä»·å¹¶ä¼˜åŒ–æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œã€‚</p>

<p>ç†æƒ³çŠ¶æ€ä¸‹ï¼Œå½“<span class="MathJax_Preview">y=h_\theta</span><script type="math/tex">y=h_\theta</script>æ—¶ï¼Œè¯¯å·®ä¸ºé›¶ï¼›<span class="MathJax_Preview">y+h_\theta = 1</span><script type="math/tex">y+h_\theta = 1</script>æ—¶ï¼Œè¯¯å·®ä¸ºæ­£æ— ç©·ã€‚Andrew Ng è®²åˆ°ç›´æ¥é‡‡ç”¨<span class="MathJax_Preview">-log(h_\theta)</span><script type="math/tex">-log(h_\theta)</script>åœ¨<span class="MathJax_Preview">(0,1]</span><script type="math/tex">(0,1]</script>ä¸Šçš„æ€§è´¨æ¥è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œä½†æ˜¯æ­£é¢æ¨å¯¼é‡‡ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡(MLE)ä»–è·³è¿‡æ²¡è®²ã€‚è¿™é‡Œæˆ‘ä»¬è®²ä¸€ä¸‹å…·ä½“çš„æ¨å¯¼ã€‚</p>

<p>å¯¹äºæ¯ä¸€ä¸ªè¾“å…¥çš„æ ·æœ¬ï¼Œç»™å®šçš„ä¸€ç³»åˆ—å‚æ•°<span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script>å¯ä»¥å‡†ç¡®é¢„æµ‹å‡ºæ­£ç¡®çš„ç±»ï¼Œè¿™æ ·çš„äº‹ä»¶æ˜¯æœ‰ä¸€å®šçš„ä¼¼ç„¶(likelihood)ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯å¯¹è¿™ä¸ªä¼¼ç„¶æ±‚æå¤§ã€‚å¯¹äºæ¯ä¸ªæ ·æœ¬<span class="MathJax_Preview">i</span><script type="math/tex">i</script>ï¼Œå‚æ•°<span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script>å¯ä»¥è¢«è½¬æ¢æˆé€»è¾‘å‡½æ•°çš„è¾“å…¥ <span class="MathJax_Preview">z_i</span><script type="math/tex">z_i</script>ã€‚æå¤§ä¼¼ç„¶å¯ä»¥å†™æˆï¼š</p>

<div class="MathJax_Preview">\arg\max_\theta \mathcal{L}(\theta \mid t,z) = \arg\max_\theta \prod_{i=1}^{n} \mathcal{L}(\theta \mid t_i,z_i)</div>
<script type="math/tex; mode=display">\arg\max_\theta \mathcal{L}(\theta \mid t,z) = \arg\max_\theta \prod_{i=1}^{n} \mathcal{L}(\theta \mid t_i,z_i)</script>

<p>ä¼¼ç„¶ <span class="MathJax_Preview">\mathcal{L}(\theta \mid t,z)</span><script type="math/tex">\mathcal{L}(\theta \mid t,z)</script> å¯ä»¥è¢«é‡æ–°å†™æˆè”åˆæ¦‚ç‡çš„å½¢å¼ <span class="MathJax_Preview">P(t,z \mid \theta)</span><script type="math/tex">P(t,z \mid \theta)</script>ã€‚ç”±æ¡ä»¶æ¦‚ç‡çš„å®šä¹‰ <span class="MathJax_Preview">P(A,B) = P(A \mid B) * P(B)</span><script type="math/tex">P(A,B) = P(A \mid B) * P(B)</script>ï¼Œæœ‰ï¼š</p>

<div class="MathJax_Preview">P(t,z \mid \theta) = P(t \mid z,\theta)P(z \mid \theta)</div>
<script type="math/tex; mode=display">P(t,z \mid \theta) = P(t \mid z,\theta)P(z \mid \theta)</script>

<p>æˆ‘ä»¬å¯¹<span class="MathJax_Preview">z</span><script type="math/tex">z</script>çš„æ¦‚ç‡ä¸æ„Ÿå…´è¶£ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™æˆï¼š</p>

<div class="MathJax_Preview">\mathcal{L}(\theta\mid t,z) = P(t \mid z,\theta) = \prod_{i=1}^{n} P(t_i \mid z_i,\theta)</div>
<script type="math/tex; mode=display">\mathcal{L}(\theta\mid t,z) = P(t \mid z,\theta) = \prod_{i=1}^{n} P(t_i \mid z_i,\theta)</script>

<p>ç”±äº <span class="MathJax_Preview">t_i</span><script type="math/tex">t_i</script> æ˜¯ä¼¯åŠªåˆ©å˜é‡ã€ä¼¯åŠªåˆ©åˆ†å¸ƒ = 0-1åˆ†å¸ƒ = ä¸¤ç‚¹åˆ†å¸ƒã€‘ï¼Œä¸”å¯¹äºç»™å®šçš„<span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script>ï¼Œ <span class="MathJax_Preview">P(t \mid z) = y</span><script type="math/tex">P(t \mid z) = y</script>ï¼Œ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡å†™ï¼š</p>

<div class="MathJax_Preview">P(t\mid z) = \prod_{i=1}^{n} P(t_i=1 \mid z_i)^{t_i} * (1 - P(t_i=1 \mid z_i))^{1-t_i} = \prod_{i=1}^{n} y_i^{t_i} * (1 - y_i)^{1-t_i}</div>
<script type="math/tex; mode=display">P(t\mid z) = \prod_{i=1}^{n} P(t_i=1 \mid z_i)^{t_i} * (1 - P(t_i=1 \mid z_i))^{1-t_i} = \prod_{i=1}^{n} y_i^{t_i} * (1 - y_i)^{1-t_i}</script>

<p>å› ä¸ºé€»è¾‘å‡½æ•°æ˜¯ä¸€ä¸ªå•è°ƒé€’å¢å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼˜åŒ– å¯¹æ•°-ä¼¼ç„¶å‡½æ•° <span class="MathJax_Preview">\arg\max_\theta \log \mathcal{L}(\theta \mid t,z)</span><script type="math/tex">\arg\max_\theta \log \mathcal{L}(\theta \mid t,z)</script>ã€‚è¿™ä¸ªæœ€å¤§å€¼å’Œæ­£å¸¸çš„ä¼¼ç„¶å‡½æ•°æœ€å¤§å€¼ç›¸åŒã€‚</p>

<div class="MathJax_Preview">log \mathcal{L}(\theta\mid t,z) = log \prod_{i=1}^{n} y_i^{t_i} * (1 - y_i)^{1-t_i} = \sum_{i=1}^{n} t_i log(y_i) + (1-t_i) log(1 - y_i)</div>
<script type="math/tex; mode=display">log \mathcal{L}(\theta\mid t,z) = log \prod_{i=1}^{n} y_i^{t_i} * (1 - y_i)^{1-t_i} = \sum_{i=1}^{n} t_i log(y_i) + (1-t_i) log(1 - y_i)</script>

<p>æ˜¾ç„¶è¿™ä¸ªå‡½æ•°æ˜¯è´Ÿå€¼ã€‚è¦æƒ³æ±‚æœ€å¤§ä¼¼ç„¶ï¼Œå°±å¾—æ±‚å‡½æ•°çš„è´Ÿå€¼çš„æœ€å°å€¼ã€‚</p>

<p>è¯¯å·®å‡½æ•° <span class="MathJax_Preview">\xi(t,y)</span><script type="math/tex">\xi(t,y)</script>è¢«ç§°ä¸º äº¤å‰ç†µè¯¯å·®å‡½æ•°ï¼ˆå¯¹æ•°æŸå¤±ï¼‰:</p>

<div class="MathJax_Preview">\xi(t,y) = - log \mathcal{L}(\theta\mid t,z) = - \sum_{i=1}^{n} \left[ t_i log(y_i) + (1-t_i)log(1-y_i) \right] = - \sum_{i=1}^{n} \left[ t_i log(\sigma(z) + (1-t_i)log(1-\sigma(z)) \right]</div>
<script type="math/tex; mode=display">\xi(t,y) = - log \mathcal{L}(\theta\mid t,z) = - \sum_{i=1}^{n} \left[ t_i log(y_i) + (1-t_i)log(1-y_i) \right] = - \sum_{i=1}^{n} \left[ t_i log(\sigma(z) + (1-t_i)log(1-\sigma(z)) \right]</script>

<p>é‡å†™ï¼š</p>

<div class="MathJax_Preview">\xi(t_i,y_i) =
   \begin{cases}
   -log(y_i) &amp; \text{if } t_i = 1 \\
   -log(1-y_i) &amp; \text{if } t_i = 0
  \end{cases}</div>
<script type="math/tex; mode=display">% <![CDATA[
\xi(t_i,y_i) =
   \begin{cases}
   -log(y_i) & \text{if } t_i = 1 \\
   -log(1-y_i) & \text{if } t_i = 0
  \end{cases} %]]></script>

<p>è¿™æ ·ï¼Œå½“ t=1 è€Œ y=0 æ—¶ï¼Œè¯¯å·®è¶‹è¿‘äºæ­£æ— ç©·ï¼›y=1 æ—¶è¯¯å·®è¶‹è¿‘äº0ã€‚</p>

<p>é‰´äº<span class="MathJax_Preview">t</span><script type="math/tex">t</script>å–å€¼é0å³1ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™å‡½æ•°ï¼š</p>

<div class="MathJax_Preview">\xi(t,y) = -t * log(y) - (1-t) * log(1-y)</div>
<script type="math/tex; mode=display">\xi(t,y) = -t * log(y) - (1-t) * log(1-y)</script>

<p>nä¸ªæ ·æœ¬çš„å’ŒåŠ èµ·æ¥ï¼Œåˆ™æœ‰ï¼š</p>

<div class="MathJax_Preview">\xi(t,y) = - \sum_{i=1}^{n} \left[ t_i log(y_i) + (1-t_i)log(1-y_i) \right]</div>
<script type="math/tex; mode=display">\xi(t,y) = - \sum_{i=1}^{n} \left[ t_i log(y_i) + (1-t_i)log(1-y_i) \right]</script>

<h3 id="section-4">é€»è¾‘å‡½æ•°çš„äº¤å‰ç†µæˆæœ¬å‡½æ•°çš„å¯¼æ•°</h3>

<div class="MathJax_Preview">\frac{\partial \xi}{\partial y} = \frac{\partial (-t * log(y) - (1-t)* log(1-y))}{\partial y} = \frac{\partial (-t * log(y))}{\partial y} +  \frac{\partial (- (1-t)*log(1-y))}{\partial y} = -\frac{t}{y} + \frac{1-t}{1-y} = \frac{y-t}{y(1-y)}</div>
<script type="math/tex; mode=display">\frac{\partial \xi}{\partial y} = \frac{\partial (-t * log(y) - (1-t)* log(1-y))}{\partial y} = \frac{\partial (-t * log(y))}{\partial y} +  \frac{\partial (- (1-t)*log(1-y))}{\partial y} = -\frac{t}{y} + \frac{1-t}{1-y} = \frac{y-t}{y(1-y)}</script>

<div class="MathJax_Preview">\frac{\partial \xi}{\partial z} = \frac{\partial y}{\partial z} \frac{\partial \xi}{\partial y} = y (1-y) \frac{y-t}{y(1-y)} = y-t</div>
<script type="math/tex; mode=display">\frac{\partial \xi}{\partial z} = \frac{\partial y}{\partial z} \frac{\partial \xi}{\partial y} = y (1-y) \frac{y-t}{y(1-y)} = y-t</script>

</article>


<aside class="author">
  <h2 class="aside-title">About</h2>

  
  <img class="me" src="/public/img/profile.jpg" alt="Puxuan Yu"/>
  

  <p>Software Engineering @ WuhanU ğŸ‡¨ğŸ‡³ , ISTJ.</p>

</aside>


<aside class="related">
  <h2 class="aside-title">Related Posts</h2>
  <ul class="related-posts">
    
    
    
      
      
        <li>
          <h4>
            <a href="/2016/12/07/image-segmention/">
              <span>Efficient Graph-based Image Segmentation</span>
              <small>12/07/16</small>
            </a>
          </h4>
        </li>
      
    
      
      
        <li>
          <h4>
            <a href="/2016/11/11/intro-to-xgboost/">
              <span>XGBoostè¯¦è§£</span>
              <small>11/11/16</small>
            </a>
          </h4>
        </li>
      
    
      
      
        <li>
          <h4>
            <a href="/2016/10/28/nnfml1/">
              <span>æœºå™¨å­¦ä¹ ä¸­çš„ç¥ç»ç½‘ç»œ-ç¬”è®°(1)</span>
              <small>10/28/16</small>
            </a>
          </h4>
        </li>
      
    
      
      
    
  </ul>
</aside>


<!-- å¤šè¯´è¯„è®ºæ¡† start -->
	<div class="ds-thread" data-thread-key='/2016/07/11/neural-network-2' data-title="æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼šé€»è¾‘åˆ†ç±»å‡½æ•°" data-url='http://puxuan.coding.me//2016/07/11/neural-network-2/'></div>
<!-- å¤šè¯´è¯„è®ºæ¡† end -->
<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"lucius0814"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->


    </main>

    





<div   id="_backdrop" class="backdrop"></div>
<aside id="_sidebar" class="sidebar" style="background-image:url('/public/img/code.jpg')">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1><a href="/">Puxuan</a></h1>
      <p>10^14 synapses in a brain, and 10^9 seconds in a life.</p>

    </div>

    <nav class="sidebar-nav">
      <ul>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/code/">Technique</a>
          </li>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/travel/">Travel</a>
          </li>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/music/">Music</a>
          </li>
        
          
          <li>
            <a class="sidebar-nav-item " href="/tag/other/">Misc</a>
          </li>
        

        

        
        
          
            
          
        
          
            
            <li>
              <a class="sidebar-nav-item " href="/about/">About</a>
            </li>
            
          
        
          
        
          
        
          
            
          
        
          
        
          
        
          
        
      </ul>
    </nav>

    <div class="sidebar-social">
      
        <a href="https://github.com/PxYu" target="_blank"><span class="icon-github"></span></a>

      

      
        <a href="https://instagram.com/pxyuwhu" target="_blank"><span class="icon-instagram"></span></a>

      

      
        <a href="https://twitter.com/pxyuwhu" target="_blank"><span class="icon-twitter-square"></span></a>

      

      
        <a href="https://facebook.com/martin.yu.5249" target="_blank"><span class="icon-facebook-square"></span></a>

      

      
        <a href="https://weibo.com/u/3290896193" target="_blank"><span class="icon-weibo"></span></a>

      


    </div>
  </div>
</aside>


    <script src="/public/js/hydejack.js" async></script>
  </body>
</html>
